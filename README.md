# 糖尿病預測模型

## 專案概述

本專案使用 BRFSS2015 健康指標數據集來預測糖尿病風險。我們採用了多種機器學習模型進行訓練和評估，最終透過集成學習方法獲得了更高的預測準確率。

### 數據集說明

我們使用了平衡的數據集 `diabetes_binary_5050split_health_indicators_BRFSS2015.csv`，其中包含相同數量的糖尿病和非糖尿病案例，以解決實際醫療數據中常見的類別不平衡問題。

- **數據來源**: BRFSS (行為風險因素監測系統) 2015年調查
- **樣本數量**: 70,692條記錄
- **特徵數量**: 21個健康相關指標
- **目標變數**: Diabetes_binary (0=無糖尿病，1=有糖尿病)

### 主要特徵

數據集包含以下關鍵健康指標：

- 高血壓 (HighBP)
- 高膽固醇 (HighChol)
- BMI 值
- 吸煙狀況 (Smoker)
- 心臟病史 (HeartDiseaseorAttack)
- 身體活動 (PhysActivity)
- 飲食習慣 (Fruits, Veggies)
- 酒精消費 (HvyAlcoholConsump)
- 醫療保健獲取 (AnyHealthcare, NoDocbcCost)
- 一般健康狀況 (GenHlth)
- 心理健康 (MentHlth)
- 身體健康 (PhysHlth)
- 行走困難 (DiffWalk)
- 人口統計學特徵 (性別、年齡、教育程度、收入)

## 模型開發流程

### 1. 數據預處理與特徵工程

- 檢查並處理缺失值
- 基於 BMI 創建類別特徵
- 根據年齡分組創建年齡類別
- 構建綜合健康指標：
  - Health_Score (綜合健康評分)
  - Risk_Score (風險因子評分)
  - Lifestyle_Score (生活方式評分)

### 2. 特徵選擇

使用隨機森林進行特徵重要性評估，選擇累積重要性達到80%的特徵。這種方法有效減少了特徵數量，同時保留了預測能力。

### 3. 模型訓練與評估

我們訓練並評估了多種機器學習模型：

- 邏輯迴歸 (Logistic Regression)
- 隨機森林 (Random Forest)
- 梯度提升 (Gradient Boosting)
- XGBoost
- 支持向量機 (SVM)

每個模型均使用以下指標進行評估：
- 準確率 (Accuracy)
- 精確率 (Precision)
- 召回率 (Recall)
- F1分數 (F1-score)
- ROC曲線和AUC值

### 4. 模型優化

對性能最佳的模型進行超參數調整，使用網格搜索和交叉驗證找到最佳參數組合。

### 5. 集成模型

將表現最好的三個模型組合成投票分類器 (Voting Classifier)，進一步提高了預測準確率。

## 實驗結果

根據混淆矩陣分析，我們的最佳模型 (SVM) 表現如下：

- 正確預測無糖尿病案例 (真陰性): 4865例
- 誤報為糖尿病 (假陽性): 2205例
- 漏報糖尿病 (假陰性): 1362例
- 正確預測糖尿病案例 (真陽性): 5707例

集成模型進一步提高了性能：
- 正確預測無糖尿病案例 (真陰性): 5009例
- 誤報為糖尿病 (假陽性): 2061例
- 漏報糖尿病 (假陰性): 1461例
- 正確預測糖尿病案例 (真陽性): 5608例

### 模型性能對比

各模型的性能指標比較：
- SVM: 準確率 74.7%，精確率 72.1%，召回率 80.7%，F1分數 76.2%
- 梯度提升: 準確率 74.9%，精確率 73.0%，召回率 79.0%，F1分數 75.9%
- 集成模型: 準確率 75.1%，精確率 73.1%，召回率 79.3%，F1分數 76.1%

## 實際應用價值

此模型可應用於：
- 初步糖尿病風險篩查
- 醫療保健資源分配優化
- 高風險人群的早期干預策略制定

## 技術實現

本專案使用 Python 實現，主要依賴的庫包括：
- Pandas 和 NumPy (數據處理)
- Scikit-learn (模型訓練與評估)
- XGBoost (梯度提升實現)
- Matplotlib 和 Seaborn (數據可視化)

## 未來改進方向

- 探索深度學習模型的適用性
- 引入更多特徵交互項
- 應用特徵選擇的其他方法
- 實現模型解釋工具以提高臨床可用性

## 如何使用

```bash
# 克隆儲存庫
git clone https://github.com/yourusername/diabetes-prediction.git
cd diabetes-prediction

# 安裝依賴
pip install -r requirements.txt

# 運行主程序
python 5050split_machine.py
```

預訓練模型和圖表將保存在 `diabetes/optimized_models` 目錄中。
